<!DOCTYPE html>
<html>
<head>
    <title>Clear Auth Storage</title>
</head>
<body>
    <h1>Clear Authentication Storage</h1>
    <div id="results"></div>
    <button onclick="clearAuthStorage()">Clear All Auth Data</button>
    <button onclick="showStoredData()">Show Stored Data</button>

    <script>
        function showStoredData() {
            const results = document.getElementById('results');
            let html = '<h2>Current Storage Contents:</h2>';
            
            // Check localStorage
            html += '<h3>localStorage:</h3><ul>';
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && (key.includes('auth') || key.includes('token'))) {
                    const value = localStorage.getItem(key);
                    html += `<li><strong>${key}:</strong> ${value ? value.substring(0, 100) + '...' : 'null'}</li>`;
                }
            }
            html += '</ul>';
            
            // Check sessionStorage
            html += '<h3>sessionStorage:</h3><ul>';
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                if (key && (key.includes('auth') || key.includes('token'))) {
                    const value = sessionStorage.getItem(key);
                    html += `<li><strong>${key}:</strong> ${value ? value.substring(0, 100) + '...' : 'null'}</li>`;
                }
            }
            html += '</ul>';
            
            // Check for specific Redux persist keys
            const persistAuth = localStorage.getItem('persist:auth');
            if (persistAuth) {
                html += '<h3>Redux Persist Auth:</h3>';
                try {
                    const parsed = JSON.parse(persistAuth);
                    html += '<ul>';
                    for (const [key, value] of Object.entries(parsed)) {
                        if (typeof value === 'string') {
                            html += `<li><strong>${key}:</strong> ${value.substring(0, 100)}${value.length > 100 ? '...' : ''}</li>`;
                        } else {
                            html += `<li><strong>${key}:</strong> ${JSON.stringify(value)}</li>`;
                        }
                    }
                    html += '</ul>';
                } catch (e) {
                    html += `<p>Error parsing: ${e.message}</p>`;
                }
            }
            
            results.innerHTML = html;
        }
        
        function clearAuthStorage() {
            // Clear all auth-related localStorage items
            const keysToRemove = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && (key.includes('auth') || key.includes('token') || key.includes('persist'))) {
                    keysToRemove.push(key);
                }
            }
            
            keysToRemove.forEach(key => localStorage.removeItem(key));
            
            // Clear all auth-related sessionStorage items
            const sessionKeysToRemove = [];
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                if (key && (key.includes('auth') || key.includes('token'))) {
                    sessionKeysToRemove.push(key);
                }
            }
            
            sessionKeysToRemove.forEach(key => sessionStorage.removeItem(key));
            
            document.getElementById('results').innerHTML = `
                <h2>âœ… Cleared Storage</h2>
                <p>Removed ${keysToRemove.length} localStorage items</p>
                <p>Removed ${sessionKeysToRemove.length} sessionStorage items</p>
                <p><strong>Now refresh the frontend app to get fresh tokens!</strong></p>
            `;
        }
        
        // Show data on load
        showStoredData();
    </script>
</body>
</html>
